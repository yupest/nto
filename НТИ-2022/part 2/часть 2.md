### **Часть 2**
#### **Предисловие**
Согласитесь, что поиск книги по жанрам на сайте - рутинный процесс, который отнял ваше драгоценное время.

Если бы у системы были настроены фильтры для подбора книги по жанрам, любому пользователю стало бы проще отыскать нужный фильм.

Поэтому стажерам компании AltFuture совместно с группой анализа данных и визуального проектирования предлагается  создать такую систему подбора книг. В системе будут не только фильтры по жанрам, но и другие особенности, которые вы узнаете на следующих шагах.

Работа разделится на 2 этапа:

1. Сбор и формирование табличных данных
1. Создание интерактивной системы подбора

При этом данные, которые вы получите на первом этапе используются во втором. Однако, на практике этапы могут быть разделены между командой разработчиков.

*Примечание*

*Вам предлагается  продемонстрировать навыки сбора данных на следующем шаге, но последующие после этого шаги можно реализовать на готовых данных, которые вам предоставляются в качестве тестового набора.*

*Примечание 2*

*Все материалы, которые вставлены в начале задач данного блока, уже должны быть просмотрены и носят вспомогательный характер. Ссылка на плейлист с ними выдавалась в образовательном курсе и в Общей информации данного курса.* 

#### **Задача 9. Сбор данных**
##### **Условие задачи**
Инструменты, которые могут потребоваться: Google Colab, для запуска кода

Материалы: 

- Сайт рассмотренный в примере: <https://yupest.github.io/nti/site/>  
- Тетрадь: <https://colab.research.google.com/drive/1OPziKE3PvCQdaNqVQjYSXddZ_TkPQ-D7?usp=sharing>
- Видео:[ ](https://youtu.be/G2U3humFe8g)[ https://youtu.be/G2U3humFe8g](https://youtu.be/G2U3humFe8g)
- Курс:[ ](https://pythontutor.ru/lessons/dicts/)[Питонтьютор - словари](https://pythontutor.ru/lessons/dicts/)

На[ ](https://yupest.github.io/nti/%D0%9D%D0%A2%D0%98-2022/books/)[сайте ](https://yupest.github.io/nti/%D0%9D%D0%A2%D0%98-2022/books/)представлена информация о книгах. В заголовках представлен код книги (индекс) и ее название. В таблице в шапке сайта перечислены категории и численные показатели, которые нужно получить в результате сбора данных. При этом зеленая колонка обозначает количество пользователей, отметивших книгу на определенную оценку. Значения оценок варьируется от -3 до 5.

Соберите данные по всем атрибутам, указанным в таблице в шапке сайта, с помощью шаблона кода. Однако, в нем нужно заполнить пропущенные значения (обозначенные знаком «**?**»). Затем, готовый код можно выполнить и сохранить таблицу в формате csv.

**1.**  #загрузка библиотек

**2.**  **import** **requests** # для отправки запроса к сайту

**3.**  **from** **bs4** **import** BeautifulSoup # для парсинга

**4.**  **import** **pandas** **as** **pd** # для создания таблицы в формате .csv

**5.**        

**6.**  # загрузка страницы сайта и создание экземпляра для парсинга

**7.**  html = requests.get("?").text

**8.**  soup = BeautifulSoup(html)

**9.**   

**10.**# переменная, в которую будем записывать строки таблицы (фильмы и их информацию)

**11.**items = []

**12.**# поиск карточек с фильмом и извлечение всей информации из них

**13.for** el **in** soup.find\_all('div', {'class':'?'}):

**14.**     

**15.**    # создаем строку таблицы и добавляем значения в ячейки

**16.**    d = {'Индекс':el.find('?').text.split(' ', **1**)[**0**],

**17.**         'Название':el.?('h1').text.split(' ', **1**)[**1**],

**18.**         '?':el.find('li',{'?':'author'}).text,

**19.**         'Жанр':[g.text **for** g **in** el.find\_all('li',{'class':'?'})],

**20.**        }

**21.**    # находим все оценки и количество проголосовавших и добавляем в виде ячеек в строку

**22.**    **for** mark, counts **in** zip(el.find\_all('li',{'?':'mark'}), el.find\_all('?',{'class':'s-text'})):

**23.**        d[mark.text] = counts.?

**24.** 

**25.**    # записываем строку в список будущей таблицы

**26.**    items.append(d)

**27.** 

**28.**# записываем строки в табличный формат csv, при этом список жанров в ячейках переносим по строкам

**29.**df\_parse = pd.DataFrame(items).explode('Жанр')

**30.**df.to\_csv('books.csv', index = False)

**31.** 

**32.**# для сохранения файла из Google Colab

**33.from** **google.colab** **import** files

**34.**files.download('books.csv')

Знаки «**?**» считайте пронумерованными от 0 до 9 в порядке их появления в коде.

Напишите программу, которая считывает список значений из входных данных, и выдает для него правильный порядок в виде перечисления индексов через пробел для знаков «**?**». То есть каждое значение из входного списка получает в соответствие индекс пропуска (под знаком «**?**»).

Разберемся на **примере** другого кода:

\1.	name = ?()

\2.	?(‘Hello, {}’.format(?))

Входные данные: print, name, input

Результат программы: 1 2 0
##### **Ответ**
Для входных данных: 

class, text, name, genre, div, book-head, find, Автор, h1, https://yupest.github.io/nti/НТИ-2022/books/

Ответ:

7 9 5 6 8 1 3 4 2 0   
##### **Решение**
Задача генеративная. 

Верная расстановка пропущенных значений

`    `0:'https://yupest.github.io/nti/НТИ-2022/books/'

`    `1:'book-head'

`    `2:'h1'

`    `3:'find'

`    `4:'Автор'

`    `5:'name'

`    `6:'genre’

`    `7:'class'

`    `8:'div'

`    `9:'text'

В строке 7 для знака “?” присваивается индекс 0, в строке 13 - 1, и так далее по порядку их встречи в коде. На вход подаются значения, которые нужно распределить в места пропусков. Значения не повторяются и гарантируется, что каждое значение используется в коде в местах пропусков 1 раз. Необходимо задать перечисленному порядку значений из входных данных индексы пропусков.

Если подставить значения в указанном порядке в код (помечены полужирным), то его можно корректно запустить и получить набор данных в табличном виде для решения следующих шагов в Части 2:

**1.**  #загрузка библиотек

**2.**  **import** **requests** # для отправки запроса к сайту

**3.**  **from** **bs4** **import** BeautifulSoup # для парсинга

**4.**  **import** **pandas** **as** **pd** # для создания таблицы в формате .csv

**5.**        

**6.**  # загрузка страницы сайта и создание экземпляра для парсинга

**7.**  html = requests.get("**https://yupest.github.io/nti/НТИ-2022/books/**").text

**8.**  soup = BeautifulSoup(html)

**9.**   

**10.**# переменная, в которую будем записывать строки таблицы (фильмы и их информацию)

**11.**items = []

**12.**# поиск карточек с фильмом и извлечение всей информации из них

**13.for** el **in** soup.find\_all('div', {'class':'**book-head**'}):

**14.**     

**15.**    # создаем строку таблицы и добавляем значения в ячейки

**16.**    d = {'Индекс':el.find('**h1**').text.split(' ', **1**)[**0**],

**17.**         'Название':el.**find**('h1').text.split(' ', **1**)[**1**],

**18.**         '**Автор**':el.find('li',{'**name**':'author'}).text,

**19.**         'Жанр':[g.text **for** g **in** el.find\_all('li',{'class':'**genre**'})],

**20.**        }

**21.**    # находим все оценки и количество проголосовавших и добавляем в виде ячеек в строку

**22.**    **for** mark, counts **in** zip(el.find\_all('li',{'**class**':'mark'}), el.find\_all('**div**',{'class':'s-text'})):

**23.**        d[mark.text] = counts.**text**

**24.** 

**25.**    # записываем строку в список будущей таблицы

**26.**    items.append(d)

**27.** 

**28.**# записываем строки в табличный формат csv, при этом список жанров в ячейках переносим по строкам

**29.**df\_parse = pd.DataFrame(items).explode('Жанр')

**30.**df.to\_csv('books.csv', index = False)

**31.** 

**32.**# для сохранения файла из Google Colab

**33.from** **google.colab** **import** files

**34.**files.download('books.csv')

#### **Примечания для дальнейшей работы**
Данные для выполнения последующих заданий вы можете получить в результате выполнения корректного кода из первой задачи. Запустить его вы можете на платформе [Google Colab](https://colab.research.google.com/drive/1nogUzo2GYb9KhN-WuEM9OTJx1Px95lDz?usp=sharing).

Или воспользуйтесь [готовым набором данных](https://raw.githubusercontent.com/yupest/nti/master/%D0%9D%D0%A2%D0%98-2022/data/books.csv).

Задания выполняйте в платформе Tableau – [онлайн ](https://public.tableau.com/app/discover)или версия приложения с [установщиком](https://drive.google.com/file/d/1y1XkJHkc3pOlYYNZhjeHcxbERIGXsubI/view?usp=sharing).

А обучающие материалы, которые могут вам помочь находятся [в данном плей-листе](https://youtube.com/playlist?list=PL6LiR0TiNuAKBb18c6sRz-TXkcCzZEfyd).

#### **Задача 10. Популярные жанры**
##### **Условие задачи**
*Инструменты: Tableau*

*Материалы:*

- [*https://youtu.be/DIEIooYBL68*](https://youtu.be/DIEIooYBL68)
- [*https://youtu.be/Wu6SZdEpNDM?t=99*](https://youtu.be/Wu6SZdEpNDM?t=99)

*Лист «Облако книжных жанров»*

Постройте облако слов по частоте упоминания **жанров**. Отрегулируйте цвет графика, чтобы его было комфортно просматривать.

Вам будет необходимо проанализировать получившееся облако слов, выявив:

1. Какое место по количеству упоминаний занимает жанр из входных данных?
1. Какая у данного жанра частота?

При этом, если частота совпадает, то считается, что эти жанры делят одно и то же место. Например:

|**Жанр**|**Частота**|
| - | - |
|Новелла|20|
|Приключения|20|
|Роман|10|
Тогда *Новелла* и *Приключения* оба находятся на первом месте, тогда как *Роман* - на втором.

Скачайте данные, внутри которых будет жанр и Запишите в ответ место и частоту ,выпавшего вам жанра через пробел.

**Sample Input:**

Роман

**Sample Output:**

1 39
##### **Ответ**
Задача генеративная.

Ответы к жанрам следующие:

- 'Роман': 1 39
- 'Приключения': 2 33
- 'Фантастика': 3 21
- 'Современная проза': 4 15
- 'Повесть': 5 14
- 'Фэнтези': 6 12
- 'О любви': 7 9
- 'Сказка': 8 8
- 'История': 9 7
- 'Рассказ': 9 7
- 'Классика': 9 7
- 'Антиутопия': 10 6
- 'О войне': 10 6
- 'Мистика': 11 5
- 'Психология': 12 4
- 'Драма': 12 4
- 'Автобиография': 13 3
- 'Юмор': 13 3
- 'Постапокалипсис': 14 2 
- 'Поэма': 14 2
- 'Детектив': 14 2
- 'Проза': 14 2
- 'Триллер': 14 2
- 'Новелла': 14 2  

Для входных данных: Роман

Ответ: 1 39
##### **Решение**
1. Данные, после выполнения кода из шага “Сбор данных” или полученные с предыдущего шага “Примечания” загружаются в платформу Tableau.
1. Создается новый лист «Облако книжных жанров».
1. Поле с количеством записей набора данных **books.csv (Count)** переносится в область Marks на поля Size и Color. 
1. Поле **Жанр** переносится в область Marks на Text.
1. Тип Marks меняется на Text.
1. Кликаем на правую кнопку мыши. Выбираем **View data**. На поле **Count of books.csv** нажимаем на иконку сортировки и оставляем по убыванию.
   ![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.001.png)
1. Значения в поле **Count of books.csv** показывают количество упоминаний. Для определения места жанра в полученном топе, считаем сверху различные значения, если значение повторяет предыдущее - номер места сохраняется.
1. Тогда, Например для входных данных “Классика” ответ будет: 9 7.

#### **Задача 11. Система подбора книг**
##### **Условие задачи**
Инструменты: Tableau

Материалы:

- <https://youtu.be/JHuPLH-2uOQ>
- <https://youtu.be/mEW94um0U0I>

Лист «Топ-10 книг»

​

Создадим систему подбора книг по оценкам пользователей. Немного о системе: пользователь указывает, какие оценки должны быть учтены при подсчете баллов. С помощью выбора True или False пользователь указывает для каждого значения балла от -3 до 5, нужно ли их включить в систему. Например, он не хочет, чтобы учитывались отрицательные баллы пользователей, тогда для оценок -3, -2 и -1 пользователь выберет значение False.

Оценки (-3, -2, -1, 1, 2, 3, 4, 5) будем называть i .

\1. Настройте параметры логического типа (Boolean) для каждой оценки i .

\2. Создайте вычисляемые поля =# mark i для каждой оценки i, где происходит проверка: включать ли в систему подбора количество оценок (голосов) с этим значением:

- Если пользователь выбрал True, то в поле записывается количество голосов пользователей из полей i ).
- Если False - голоса не учитываются, вместо них выводится значение 0.

\3. После чего формируем единый показатель **=# Баллы** как сумма баллов по оценкам. Сейчас в полях **=# mark i** записано количество голосов пользователей, чтобы получить баллы нужно каждое слагаемое домножить на значение соответствующей оценки i (вместо многоточия, слагаемые по остальным оценкам):

Баллы=[mark −3]⋅−3+[mark −2]⋅−2+...+[mark 5]⋅5![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.002.png)

**Пример:** пользователь учитывает в системе только оценки 4 и 5, тогда в поле =# Баллы будет подсчитываться сумма баллов по этим оценкам - 4\*[количество голосов за оценку 4] + 5\*[количество голосов за оценку 5]. Остальные оценки также вписываются в формулу, однако их количество будет равняться 0, поэтому к примеру выше прибавляются нулевые значения баллов для этих оценок.

Постройте столбчатую диаграмму книг по названию и по среднему (нужно установить агрегацию Average) значению поля =# Баллы , отсортируйте по нему в порядке убывания и покажите только топ первых 10.

В приложенных входных данных указаны значения True или False для каждой оценки. Укажите Баллы без округлений с заданными параметрами для первой книги в топе*.*
##### **Ответ**
Задача генеративная.

Пример входных данных:

-3: False

-2: True

-1: True

1 : True

2 : True

3 : True

4 : True

5 : True

Ответ:

17371
##### **Решение**
1. Создать параметр (Create Parameter) логического типа. Назвать в соответствии с оценкой.
   ![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.003.png)
1. Повторить 1ое действие для всех оценок: -3, -2, -1, 1, 2, 3, 4, 5. Должно получиться 8 параметров с названиями оценок. 
   ![Изображение выглядит как стол

Автоматически созданное описание](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.004.png)
1. Создать вычисляемое поле, в котором производится проверка на значение в параметре. Если в параметре выбрано True, то количество голосов по такой оценке нужно будет учитывать. Если значение False, значение не учитывается и устанавливается на его месте - 0. Поле назвать **mark i**, где **i** - оценка.
   ![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.005.png)
1. 3-ье действие повторить для всех оценок: -3, -2, -1, 1, 2, 3, 4, 5. При этом заменяя параметр и поле, в котором содержится количество голосов по оценке.
1. Создать вычисляемое поле (Create Calculated field). Прописать формулу для подсчета общего числа баллов для книг. Баллы подсчитываются по формуле из текста задачи. 
   ![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.006.png)
1. Создать лист и назвать его “Топ-10 книг”.
1. Перетащить поле Название в Rows. 
1. Перетащить поле Баллы в Columns. на среднее - ПКМ -> Measure -> Average.
1. Диаграмма сортируется по убыванию через вкладку Sorted
   ![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.007.png)
1. В новом вычисляемом поле index вводится функция INDEX(). Оно перемещается в область фильтра. Настройки выставляются с ограничением значения до 10.
1. В Label области Marks установить значение **Show mark labels**.
1. Параметры нужно отразить на листе. Для этого с зажатой клавишей Shift выделяем параметры, созданные в пункте 2. В выпадающем списке выбрать **Show Parametr**. Протестировать визуализацию, изменяя значения параметров. 
1. Из входных данных получить значения для установки параметров в соответствии с их названиями. Пример: 
   -3: False
   -2: False
   -1: True
   1 : True
   2 : True
   3 : False
   4 : False
   5 : False
1. Узнать баллы у первой книге в топе (с большим количеством баллов).
1. 3356
   ![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.008.png)

#### **Задача 12. Библиотека на координатной плоскости**
##### **Условие задачи**
*Инструменты: Tableau*

*Материалы:*

- [*https://youtu.be/glVU40AUkbw*](https://youtu.be/glVU40AUkbw)
- [*https://youtu.be/mEW94um0U0I?t=391*](https://youtu.be/mEW94um0U0I?t=391)
- [*https://youtu.be/17AXEeeCOxs?t=354*](https://youtu.be/17AXEeeCOxs?t=354)

*Лист «Библиотека»*

Чтобы пользователь мог увидеть все книги, предоставьте такую возможность в виде диаграммы рассеивания:

- по осям:
  - средним значениям баллов - поле **=# Баллы**, которое получено на предыдущем шаге,
  - среднему значению количества голосов - поле **=# Количество голосов**
- и по цвету точек:
  - среднему значению оценке - поле **=# Средняя оценка**.

*Средние значения - это значит, что установлена агрегация Average (AVG, а не SUM)*

Поле **=# Количество голосов** нужно подсчитать через новое вычисляемое поле как сумму голосов по каждой оценке  **=# mark i**

Количество голосов=[mark −3]+[mark −2]+...+[mark 5]![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.002.png)

Поле **=# Средняя оценка** нужно подсчитать через новое вычисляемое поле как отношение баллов к количеству голосов.

` `Средняя оценка=Количество голосов/Баллы​![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.002.png)![Click and drag to move](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.009.png)

Выражение в формуле округлить до целого с помощью метода **ROUND(...).**

Установите в параметрах для учета оценок значения **True**.

Во входных данных указана **Средняя оценка**. Найдите на координатной плоскости соответствующее значение средней оценки и укажите в ответе Баллы и Количество голосов через пробел.
##### **Ответ**
Задача генеративная.

Для входных данных: -1

Ответ: -3 4
##### **Решение**
1. Создать новый лист “Библиотека”
1. Перетащитьполя:  Баллы в Rows, Количество голосов в Columns или наоборот.
1. Настроить агрегацию этих полей - в выпадающем списке через ПКМ -> Measure -> Average.
1. Перенести в область Marks на поле Details поле Название. 
1. Все параметры, настраиваемые в задаче 11 установить в значение True.
1. Получить во входных данных значение средней оценки. Найти с помощью всплывающего окна подсказки (tooltip) на координатной плоскости книгу, соответствующую такой оценке.
1. Например для входных данных 5, ответом будет 5 и 1
   ![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.010.png)
#### **Задача 13. Оценки пользователей**
##### **Условие задачи**
*Инструменты: Tableau*

*Материалы (данные материалы были рассмотрены в образовательном курсе и носят вспомогательный характер): [https://youtu.be/16_p55s_Slo*](https://youtu.be/16_p55s_Slo)*

*Лист «Оценки»*

Отобразите среднее количество проголосовавших по оценкам (поля: -3, -2, ... 5) в виде линейного графика. 

Добавьте фильтр по жанрам.

*Из входных данных название жанра установите в фильтр по* жанрам *и узнайте количество голосов по* оценке.

Укажите  значение среднего количества голосов , округлив до целого.

*На решение данной задачи отведено 3 попытки* 

**Sample Input:**

Жанр: Роман

Оценка: 2

**Sample Output:**

161
##### **Ответ**
Задача генеративная.

Для входных данных: 
Жанр: Роман
Оценка: 2

Ответ: 161
##### **Решение**
1. Создать новый лист “Оценки”
1. Перетащить Measure Names в область фильтра. Выбрать поля: -3, -2, -1, 1, 2, 3, 4, 5.
1. Перетащить поле Measure Names в Columns, Measure Values в Rows. Агрегацию для полей в списке Measure Values поменять на Average через ПКМ -> Measure.
   ![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.011.png)
1. Поменять вид Marks на Line.
1. В область фильтра добавить поле Жанр. В выпадающем списке выбрать Show filter.
1. Из входных данных установить значение жанра (Роман) в фильтре жанра.
1. Навести курсор на точку с оценкой из входных данных и записать в ответ значение в ней (161) без округлений.
   ![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.012.png)
#### **Задача 14. Дашборд**
##### **Условие задачи**
*Инструменты: Tableau*

*Материалы:*

- [*https://youtu.be/17AXEeeCOxs*](https://youtu.be/17AXEeeCOxs)
- [*https://youtu.be/XzyreHNW8a4*](https://youtu.be/XzyreHNW8a4)

*Результат: Дашборд*

Соберите дашборд из готовых листов:

- Облако книжных жанров
- Топ-10 книг
- Библиотека
- Оценки

Убедитесь в том, что все настраиваемые фильтры, параметры и легенды находятся на дашборде.

В последующих шагах этой "Части 2" настраиваются различные экшены для этого дашборда.
#### **Задача 14.1 Фильтрация по жанру**
##### **Условие задачи**
*Инструменты: Tableau*

*Материалы (данные материалы были рассмотрены в образовательном курсе и носят вспомогательный характер):*

- [*https://youtu.be/17AXEeeCOxs*](https://youtu.be/17AXEeeCOxs)
- [*https://youtu.be/XzyreHNW8a4*](https://youtu.be/XzyreHNW8a4)

*Результат: Дашборд*

Настройте экшены (Action):

- Для листа "Облако книжных жанров" при выборе слова (жанра) - фильтр на все остальные листы.

Установите в параметрах для учета оценок значения **True**.

Во входных данных указан **жанр** и **номер** в топе с листа "Топ-10 книг".

1. Выберите выпавший жанр на листе "Облако книжных жанров".
1. Посчитайте и найдите нужный столбец (книгу) по номеру\*.
1. Определите количество баллов для найденной книги.
1. Узнайте диапазон значений средней оценки из легенды цвета для листа "Библиотека на координатной плоскости".
1. Запишите в ответ последовательно через пробел: количество баллов, минимальную границу средней оценки и максимальную.

\*Номер - это место в топе, номер 1 соответствует книге с большим количеством баллов.

На решение данной задачи отведено 3 попытки 
##### **Ответ**
Задача генеративная.

Для входных данных:
Жанр: Роман
Номер: 1

Ответ: 14671 0 5 
##### **Решение**
1. Перейти на вкладку Dashboard -> Actions -> Add Action -> Filter.
1. В области Source Sheets установить галочку только на листе “Облако книжных жанров”.
1. Run action on установить в Select.
1. В области Target Sheets установить галочки для всех листов.
1. Clearing the selection will установить в Show all values.
1. Нажать OK.
1. Из входных данных получить значение жанра и выбрать его на облаке слов - кликнуть на нужный жанр.
1. Из входных данных узнать номер, посчитать в топе книги до нужного номера и определиться с количеством баллов (для 1 номера - 14671).
1. Из легенды цвета к листу “Библиотека” определить диапазон оценок (0, 5).
   ![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.013.png)
#### **Задача 14.2 Подсветка характеристик книги**
[инфографика; Tableau]
##### **Условие задачи**
Инструменты: Tableau

Материалы (данные материалы были рассмотрены в образовательном курсе и носят вспомогательный характер):

- <https://youtu.be/17AXEeeCOxs>
- <https://youtu.be/XzyreHNW8a4>

Сбросьте все установленные фильтры. Установите в параметрах для учета оценок значения **True**.

Настройте экшен (Action) для листа "Топ-10 книг": при выборе столбца (книги) подсветка (Highlight) элементов точечной диаграммы (лист "Библиотека").

Во входных данных указан номер книги в топ-10 (диапазон от 1 до 10). Выберите соответствующий столбец и узнайте из подсказки для подсвеченной точки:

- количество проголосовавших
- среднюю оценку

В ответ запишите перечисленные значения последовательно через пробел.

*На решение данной задачи отведено 3 попытки* 
##### **Ответ**
Задача генеративная.

Для входных данных: 1

Ответ: 6217 2
##### **Решение**
1. Перейти на вкладку Dashboard -> Actions -> Add Action -> Highlight.
1. В области Source Sheets установить галочку только на листе “Топ-10 книг”.
1. Run action on установить в Select.
1. В области Target Sheets установить галочку для листа “Библиотека”.
1. Target Highlighting установить в All Fields.
1. Нажать OK.
1. Из входных данных получить номер столбца для листа “Топ-10 книг”, например 1. Кликнуть на соответствующий столбец.
1. ` `Навести курсор на подсвеченную точку из облака точек “Библиотека”. Узнать количество проголосовавших и среднюю оценку (6217 2).
   ![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.014.png)
#### **Задача 15. Этап проектирования**
##### **Условие задачи**
На картинке представлены возможные сценарии спроектированные для чат-бота "Библиотекарь" на основе аналитического дашборда из Tableau (Часть 2).

Укажи порядок развития цельного диалога, если известно, что все выборы пользователя учитываются в последующих.

` `![](Aspose.Words.cf85ed95-5198-4ee3-990e-8ebefee3ce8a.015.png)

В качестве ответа запишите цепочку диалога из букв нижнего регистра через пробел, например: а б в
##### **Ответ**
б г е д ж
##### **Решение**
Необходимо проанализировать полученный дашборд Tableau и ответить в какой последовательности и какие функции он может выполнять.


|Часть диалога|Рассуждение|Возможный порядок|
| :- | :- | :- |
|а|такой функционал отсутствует||
|б|предположим, что пользователь изначально не знает какие жанры есть в списке и в первую очередь должен получить его|б|
|в|такой функционал отсутствует||
|г|прежде чем выбрать жанр, нужно узнать, какие жанры есть, значит перед г идет б|б г|
|д|диалог выводит книгу, а в варианте е спрашивается, какой номер книги вывести, значт е перед д|е д|
|е|в е предлагают вывести книгу по ее номеру, однако вывода не последовало, значит требуется ввод еще каких-то данных, например варианта д|е д|
|ж|выдаются показатели книги, значит книга была получена ранее, на шаге д|е д ж|
Осталось определиться, что идет раньше: связка **б г** или **е д ж.** Из условия ясно, что каждое действие пользователя учитывается в последующих решениях диалога, значит сначала выбирается не книга, а жанр, в который входят несколько книг. Тогда: б г е д ж является ответом.

